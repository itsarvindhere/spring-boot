In the previous section, we saw how we can find courses for an instructor when we have fetch type as "LAZY".

The solution was fine but it required an extra query.

What if we had some option such that it will fetch teh instructor and the courses in a single query and still keep the "LAZY" option available?

Well, for that, we can add a new method in the DAOImpl to fetch the instructor and also the associated courses. And in this new method, when we write our query, we will use something called "JOIN FETCH".

    @Override
    public Instructor findInstructorByIdJoinFetch(int id) {
        TypedQuery<Instructor> query = entityManager.createQuery("FROM Instructor i JOIN FETCH i.courses WHERE i.id = :data", Instructor.class);

        query.setParameter("data", id);

        return query.getSingleResult();
    }

So, what is this "JOIN FETCH"?

The "JOIN FETCH" is similar to "EAGER" loading. So now, even with LAZY loading, the code will still retrieve the "Instructor" as well as the "Courses".

JOIN FETCH is a great way to address the "LazyInitializationException" when using Hibernate as you can initialize entity associations using the FetchType.LAZY fetching strategy along with the main entity you are fetching.

Now, what is the use of this?

Well, imagine a scenario where we just need the "Instructor" details. In that case, we simply need to use the appDAO.findInstructorByid() method. And since we are using LAZY loading, it will not fetch the courses.

Now imagine that we also need the courses. And in that case, we can use this new method that we created for that. So, even with "LAZY" fetching, we can still fetch both the "Instructor" and the "Courses" using "JOIN FETCH". So, we get the best of both worlds.

So now, we can use this new method in our main file if we want to fetch an instructor with the courses - 

    private void findInstructorWithCoursesJoinFetch(AppDAO appDAO) {

		int id = 1;

		System.out.println("Finding instructor with id: "+ id);
		Instructor instructor = appDAO.findInstructorByIdJoinFetch(id);
		System.out.println("Instructor: " + instructor);
		System.out.println("The associated courses: " + instructor.getCourses());
		System.out.println("DONE!");
	}

Note that now, we have a single query and it gives us both the instructor and the courses. We do not have to call a separate method for the courses like we had to do before. And all this happens with fetch type still being "LAZY".
